(function(e){function t(t){for(var n,a,r=t[0],c=t[1],l=t[2],_=0,h=[];_<r.length;_++)a=r[_],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(h.length)h.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],n=!0,r=1;r<i.length;r++){var c=i[r];0!==o[c]&&(n=!1)}n&&(s.splice(t--,1),e=a(a.s=i[0]))}return e}var n={},o={index:0},s=[];function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var d=c;s.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"034f":function(e,t,i){"use strict";i("85ec")},1:function(e,t){},"1b11":function(e,t){e.exports={line:{xAxis:{type:"category",name:"日期",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],nameLocation:"center",nameGap:20,axisLine:{show:!0,lineStyle:{color:"black"}},splitLine:{show:!0,lineStyle:{color:"#ccc"}}},tooltip:{trigger:"axis"},yAxis:{type:"value",name:"数量",axisLine:{show:!0,lineStyle:{color:"black"}},splitLine:{show:!0,lineStyle:{color:"#ccc"}}},grid:[{show:!0,backgroundColor:"rgba(0,0,0,0.05)",containLabel:!0,borderColor:"black",zlevel:2,borderWidth:1,top:30,right:10,bottom:20,left:10}],series:[{data:[150,230,224,218,135,147,260],type:"line"}]}}},"1c67":function(e,t,i){},2042:function(e,t,i){"use strict";i("c473")},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),o=i("5c96"),s=i.n(o),a=(i("0fae"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("router-view")],1)}),r=[],c=(i("c975"),i("96cf"),i("1da1")),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:"main"+(e.darkmode?" dark_mode":"")+(e.read_mode?" read_mode":""),attrs:{id:"app_"}},[i("div",{class:e.position_mode?"position_mode":"",attrs:{id:"main"}},[i("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("el-header",e._l(e.tool_bar_list,(function(t){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],key:t.name,class:"header_item "+(t.enable?"enable":"disable"),style:"width:"+t.width+"px;"+t.style},[i("div",{staticClass:"header_btn",on:{click:function(e){t.enable&&"btn"!=t.type&&t.click()}}},[i("i",{class:t.icon}),e._v(" "+e._s(t.title)+" "),"btn"==t.type?i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(e){return t.click()}},model:{value:t.enable,callback:function(i){e.$set(t,"enable",i)},expression:"item.enable"}}):e._e()],1),i("div",{staticClass:"header_name"},[e._v(e._s(t.name))])])})),0),i("el-main",{staticStyle:{height:"calc(100vh - 80px)",width:"calc(100vw - 20px)","border-radius":"10px","box-shadow":"0px 10px 20px -2px rgba(0,0,0,.2)",margin:"10px",padding:"0px"},attrs:{id:"antv_container"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.pushed_pic_config.show,expression:"pushed_pic_config.show"}],staticClass:"big_board"},[i("div",{staticClass:"behind_",on:{click:function(t){e.pushed_pic_config.show=!1}}}),i("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.pushed_pic_config.loading,expression:"pushed_pic_config.loading"}],staticClass:"edit_board"},[i("img",{staticStyle:{width:"100%"},attrs:{id:"pushed_image",src:e.pushed_pic_config.base64||e.pushed_pic_config.url}}),i("p",{directives:[{name:"show",rawName:"v-show",value:""==e.pushed_pic_config.base64&&""==e.pushed_pic_config.url&&!e.pushed_pic_config.pushed,expression:"pushed_pic_config.base64=='' && pushed_pic_config.url==''  && !pushed_pic_config.pushed"}],staticStyle:{"text-align":"center"}},[e._v("NO IMAGE!")]),i("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"照片链接"},model:{value:e.pushed_pic_config.url,callback:function(t){e.$set(e.pushed_pic_config,"url",t)},expression:"pushed_pic_config.url"}}),i("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"照片链接"},model:{value:e.pushed_pic_config.name,callback:function(t){e.$set(e.pushed_pic_config,"name",t)},expression:"pushed_pic_config.name"}}),e.pushed_pic_config.url.length>0&&e.pushed_pic_config.name.length>0?i("div",{staticClass:"btn green",on:{click:e.__upload_pic_to_gitee_file}},[e._v("上传图片")]):e._e(),e.pushed_pic_config.url.length>0?i("div",{staticClass:"btn green",on:{click:e.__tool_add_pic_2}},[e._v("添加到画布")]):e._e()],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.secretKey_show,expression:"secretKey_show"}],staticClass:"big_board"},[i("div",{staticClass:"behind_",on:{click:function(t){e.secretKey_show=!1}}}),i("el-card",{staticClass:"edit_board secretKeysboard"},[i("div",{staticClass:"line"},[e._v(" "+e._s(e.file_name+"."+e.file_type)+": "),i("el-input",{attrs:{value:e.secretKeys[e.file_name+"."+e.file_type]}})],1),e.file_name+"."+e.file_type in e.secretKeys?i("div",{staticClass:"btn red",on:{click:e.__tool_remove_secret_key}},[e._v("移除")]):i("div",{staticClass:"btn green",on:{click:e.__tool_add_secret_key}},[e._v("添加")])])],1),e.first_load?i("div",{staticClass:"first_load_cover"},[i("div",{staticClass:"first_load_board"},[e.read_mode?i("div",[e._v(" "+e._s(e.cover_msg)+" ")]):i("div",[e._v(" Choose a Operation: "),i("div",{staticClass:"btn green iconfont icon-new",on:{click:e.__init_a_blank_project}},[e._v(" Create")]),e.gitee_enable?i("div",{staticClass:"btn green iconfont icon-storage",on:{click:e.__init_an_online_project}},[e._v(" Open")]):e._e()])])]):e._e(),!e.read_mode&&e.node_config.show?i("div",{staticClass:"config_board node_config_board"},[i("div",{staticClass:"board_title"},[i("el-row",{staticStyle:{"margin-top":"0px"}},[i("el-col",{attrs:{span:18}},[e._v(" 编辑 ")]),i("el-col",{attrs:{span:6}})],1),e.markdown_mode?i("div",{staticClass:"btn green",staticStyle:{height:"10px",width:"10px","line-height":"10px","border-radius":"20px",position:"absolute",top:"0px",right:"10px","font-size":"14px"},on:{click:function(t){e.markdown_mode=!1}}},[e._v("X")]):e._e()],1),i("el-card",[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("标题")])]),i("el-input",{attrs:{placeholder:"请输入内容"},on:{change:e.__change_node_title},model:{value:e.node_config.title,callback:function(t){e.$set(e.node_config,"title",t)},expression:"node_config.title"}})],1),i("el-card",[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("备注 "),i("el-button",{staticStyle:{background:"transparent",border:"0px"},attrs:{plain:"",icon:"el-icon-edit"},on:{click:function(t){e.markdown_mode=!0}}})],1)]),i("el-input",{class:e.markdown_mode?"markdown_mode":"",attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},on:{change:e.__change_node_note},model:{value:e.node_config.note,callback:function(t){e.$set(e.node_config,"note",t)},expression:"node_config.note"}})],1),i("el-card",[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v(" 主题 ")]),i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.__change_node_style},model:{value:e.node_config.style,callback:function(t){e.$set(e.node_config,"style",t)},expression:"node_config.style"}},e._l(e.node_styles,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),"fold"==e.node_config.style?i("el-row",{staticClass:"line"},[i("el-col",{attrs:{span:18}},[e._v("备注显示")]),i("el-col",{attrs:{span:6}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.__change_node_fold},model:{value:e.node_config.fold,callback:function(t){e.$set(e.node_config,"fold",t)},expression:"node_config.fold"}})],1)],1):e._e(),"pin"==e.node_config.style?i("el-card",[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("标记")])]),i("el-input",{attrs:{placeholder:"请输入内容"},on:{change:e.__change_node_pin},model:{value:e.node_config.pin,callback:function(t){e.$set(e.node_config,"pin",t)},expression:"node_config.pin"}})],1):e._e(),i("el-row",{staticClass:"line"},[i("el-col",{attrs:{span:18}},[e._v("大小")]),i("el-col",{attrs:{span:6}},[i("el-button-group",[i("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.__increase_node_scale}}),i("el-button",{attrs:{icon:"el-icon-minus"},on:{click:e.__decrease_node_scale}})],1)],1)],1),0!=e.selected_node.store.data.idx?i("div",{staticClass:"btn",on:{click:e.__del_node}},[e._v("Delete")]):e._e()],1):e._e(),e.node_config.show&&""!=e.node_config.note?i("div",{class:"md_node_note"+(e.markdown_mode?" markdown_mode":""),attrs:{id:"node_note"}},[i("div",{class:"btn green "+(e.node_note_raw_text?"el-icon-tickets":"el-icon-notebook-2"),staticStyle:{width:"10px","border-radius":"20px",height:"10px","font-size":"10px","line-height":"10px"},on:{click:function(t){e.node_note_raw_text=!e.node_note_raw_text}}}),e.node_note_raw_text?i("textarea",{staticStyle:{width:"30vw",border:"0px",height:"50vh","border-radius":"5px",padding:"5px"},domProps:{value:e.node_config.note}}):i("div",{domProps:{innerHTML:e._s(e.markdown.render(e.node_config.note))}})]):e._e(),e.image_config.show&&""!=e.image_config.url?i("img",{staticClass:"preview_pic_note",staticStyle:{cursor:"zoom-in"},attrs:{id:"pushed_image",src:e.image_config.url},on:{click:function(t){e.image_config.fullscreen=!0}}}):e._e(),!e.read_mode&&e.edge_config.show?i("div",{staticClass:"config_board edge_config_board"},[i("div",{staticClass:"board_title"},[e._v(e._s(e.edge_config.title))]),i("el-card",[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("标题")])]),i("el-input",{attrs:{placeholder:"请输入内容"},on:{change:e.__change_edge_label},model:{value:e.edge_config.label,callback:function(t){e.$set(e.edge_config,"label",t)},expression:"edge_config.label"}})],1),i("div",{staticClass:"btn",on:{click:e.__del_edge}},[e._v("Delete")])],1):e._e(),!e.read_mode&&e.group_config.show?i("div",{staticClass:"config_board group_config_board"},[i("div",{staticClass:"board_title"},[e._v("编辑")]),i("el-card",{staticStyle:{"margin-top":"10px"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v(" 主题 ")]),i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.__change_group_style},model:{value:e.group_config.style,callback:function(t){e.$set(e.group_config,"style",t)},expression:"group_config.style"}},e._l(e.group_styles,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),i("div",{staticClass:"btn",on:{click:e.__del_group}},[e._v("Delete")])],1):e._e(),!e.read_mode&&e.chart_config.show?i("div",{staticClass:"config_board chart_config_board"},[i("div",{staticClass:"board_title"},[e._v("编辑")]),i("el-card",{staticStyle:{"margin-top":"10px"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v(" 主题 ")]),i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.chart_config.style,callback:function(t){e.$set(e.chart_config,"style",t)},expression:"chart_config.style"}},e._l(e.chart_styles,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),i("el-card",{staticStyle:{"margin-top":"10px"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v(" 信息 ")]),i("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请选择"},model:{value:e.chart_config.title,callback:function(t){e.$set(e.chart_config,"title",t)},expression:"chart_config.title"}},[i("template",{slot:"prepend"},[e._v("Title")])],2),i("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请选择"},model:{value:e.chart_config.x_axis,callback:function(t){e.$set(e.chart_config,"x_axis",t)},expression:"chart_config.x_axis"}},[i("template",{slot:"prepend"},[e._v("X Axis")])],2),i("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请选择"},model:{value:e.chart_config.y_axis,callback:function(t){e.$set(e.chart_config,"y_axis",t)},expression:"chart_config.y_axis"}},[i("template",{slot:"prepend"},[e._v("Y Axis")])],2),i("el-input",{attrs:{placeholder:"请选择"},model:{value:e.chart_config.data,callback:function(t){e.$set(e.chart_config,"data",t)},expression:"chart_config.data"}},[i("template",{slot:"prepend"},[e._v("Data")])],2)],1),i("div",{staticClass:"btn green",on:{click:e.__update_chart}},[e._v("Update Chart")]),i("div",{staticClass:"btn",on:{click:e.__del_chart}},[e._v("Delete")])],1):e._e(),!e.read_mode&&e.image_config.show?i("div",{staticClass:"config_board image_config_board"},[i("div",{staticClass:"board_title"},[e._v(e._s(e.image_config.title))]),i("el-card",[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("图片链接")])]),i("el-input",{attrs:{placeholder:"请输入内容"},on:{change:e.__change_image_url},model:{value:e.image_config.url,callback:function(t){e.$set(e.image_config,"url",t)},expression:"image_config.url"}})],1),i("div",{staticClass:"btn",on:{click:e.__del_image}},[e._v("Delete")])],1):e._e(),!e.read_mode&&e.file_config.show?i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.file_config.loading,expression:"file_config.loading"}],staticClass:"config_board file_config_board"},[i("div",{staticClass:"board_title"},[e._v(e._s(e.file_config.title))]),i("div",{staticStyle:{display:"flex"}},[i("div",{staticClass:"btn blue iconfont icon-refresh",on:{click:e.__get_gitee_files}}),i("div",{staticClass:"btn blue iconfont icon-new",on:{click:e.__add_file_group}}),i("div",{staticClass:"btn green iconfont icon-upload",on:{click:e.__upload_file_group}})]),e._l(e.file_config.groups,(function(t,n){return i("div",{key:t.name,staticClass:"group_item"},[i("p",{staticStyle:{"font-size":"1.2rem","font-weight":"bold","line-height":"20px",margin:"5px 0px"}},[e._v(e._s(t.name))]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length<=0,expression:"group.list.length<=0"}],staticClass:"btn red",staticStyle:{width:"100%"},on:{click:function(t){return e.__delete_file_group(n)}}},[e._v("Delete Group")]),i("draggable",{staticClass:"list-group",attrs:{list:t.list,group:"files"}},e._l(t.list,(function(t){return i("div",{key:t.path,staticClass:"file_item list-group-item"},[i("div",{class:t.path in e.secretKeys?"encrypted":"open",staticStyle:{width:"100%",float:"right","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},on:{click:function(i){return e.__load_gitee_file(t.path,t.sha)}}},[i("i",{staticClass:"el-icon-document"}),e._v(e._s(t.path.split("."+e.file_type)[0])+" ")])])})),0)],1)}))],2):e._e(),e.image_config.fullscreen?i("div",{staticClass:"fullscreen_image",style:{backgroundImage:"url("+e.image_config.url+")"},on:{click:function(t){e.image_config.fullscreen=!1}}}):e._e()],1)],1),i("div",{class:e.position_mode?"position_mode":"",attrs:{id:"center"},on:{click:function(t){e.position_mode=!1}}}),i("div",{class:e.position_mode?"position_mode":"",attrs:{id:"right"}},[e._l(e.positions,(function(t){return i("div",{key:t.name,staticClass:"btn green",staticStyle:{height:"40px","line-height":"40px",padding:"0px",width:"calc(100% - 40px)",overflow:"hidden"}},[i("div",{staticStyle:{width:"calc(100% - 40px)",background:"transparent"},attrs:{title:t.name},on:{click:function(i){return e.to_position(t)}}},[e._v(e._s(t.name))]),e.read_mode?e._e():i("i",{staticClass:"el-icon-close close-btn",staticStyle:{width:"40px","line-height":"40px"},on:{click:function(i){return e.delte_position(t)}}})])})),0==e.positions.length?i("span",{staticStyle:{position:"absolute",top:"20px",left:"0px",width:"100%"}},[e._v("No Locations")]):e._e()],2),e.read_mode?e._e():i("div",{class:e.position_mode?"position_mode":"",attrs:{id:"bottom"}},[i("div",{staticClass:"btn blue",staticStyle:{width:"100px"},on:{click:e.add_position}},[i("i",{staticClass:"el-icon-add-location"}),e._v(" 添加定位")])])])},d=[],_=(i("99af"),i("4160"),i("a15b"),i("d81d"),i("fb6a"),i("a434"),i("b0c0"),i("a9e3"),i("d3b7"),i("ac1f"),i("25f0"),i("6062"),i("3ca3"),i("5319"),i("1276"),i("498a"),i("159b"),i("ddb0"),i("bf19"),i("5530")),h=i("b85c"),g=i("5728"),f=i("b76a"),u=i.n(f),p=i("8647"),m=i.n(p),v=i("1b11"),b=i.n(v),y=i("d722"),w=(i("be35"),i("d4cd")),x=i.n(w),k=i("5710"),C=i.n(k),$=(i("dd49"),i("c4b1"),window.matchMedia("(prefers-color-scheme: dark)").matches),S=i("3452"),N=x()();N.use(i("b792"),{inline:!0}),N.use(C.a);var T=i("3eba");function D(e,t){var i=document.getElementById(e+"box").getElementsByClassName("title")[0];i.innerHTML=N.render(t.title);var n=b.a[t.style];try{n["xAxis"]["name"]=t.x_axis.split(":")[0]}catch(s){n["xAxis"]["name"]="x"}n["xAxis"]["data"]=t.x_axis.split(":")[1].split(","),n["yAxis"]["name"]=t.y_axis;try{n["series"][0]["data"]=t.data.split(",")}catch(s){return}var o=T.init(document.getElementById(e+"chart"));o.setOption(n),o.resize()}i("cd12"),i("ef97"),i("b11c"),i("007d"),i("d28f");var E={inherit:"edge",attrs:{line:{strokeWidth:2}},connector:{name:"rounded"},router:{name:"manhattan",args:{startDirections:["bottom","left","right"],endDirections:["top"]}},defaultLabel:{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{label:{fill:"trsnaparent",fontSize:12,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},body:{ref:"label",fill:"white",stroke:"#333",strokeWidth:2,rx:4,ry:4,refWidth:"140%",refHeight:"140%",refX:"-20%",refY:"-20%"}},position:{distance:.5,options:{absoluteDistance:!0,reverseDistance:!0}}}},j={groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}}}},items:[{group:"top"},{group:"bottom"},{group:"left"},{group:"right"}]};g["a"].registerEdge("edge",E,!0),g["a"].registerHTMLComponent("first",(function(e){var t=e.getData(),i=document.createElement("div");return i.innerHTML="<div class='inner_text' id='"+t["id"]+"box'><div class='title'>"+N.render(t["title"])+"</div></div>",i.className="node first "+t["style"],i})),g["a"].registerHTMLComponent("second",(function(e){var t=e.getData(),i=document.createElement("div");return i.innerHTML="<div class='inner_text'  id='"+t["id"]+"box'><div class='title'>"+N.render(t["title"])+"</div></div>",i.className="node second "+t["style"],i.id=t["id"],i})),g["a"].registerHTMLComponent("note",(function(e){var t=e.getData(),i=document.createElement("div");return i.innerHTML="<div class='inner_text'  id='"+t["id"]+"box'><div class='pinner'>"+t["pin"]+"</div><div class='pinner'>"+t["pin"]+"</div><div class='title'>"+N.render(t["title"])+"</div><div class='content'>"+N.render(t["note"])+"</div></div>",i.className="node note "+t["style"]+(t["fold"]?" folding":" non-folding")+(t["size"]?" "+t["size"]:""),i.id=t["id"],i})),g["a"].registerHTMLComponent("others",(function(e){var t=e.getData(),i=document.createElement("div");return i.innerHTML="<div class='inner_text'  id='"+t["id"]+"box'><div class='title'>"+N.render(t["title"])+"</div></div>",i.className="node others "+t["style"],i.id=t["id"],i})),g["a"].registerHTMLComponent("group",(function(e){var t=e.getData(),i=document.createElement("div");return i.innerHTML="<div class='inner_text'  id='"+t["id"]+"box'></div>",i.className="node group "+t["style"],i.id=t["id"],i})),g["a"].registerHTMLComponent("chart",(function(e){var t=e.getData(),i=document.createElement("div");return i.innerHTML="<div class='inner_text'  id='"+t["id"]+"box'><div class='title'>"+t["title"]+"</div><div class='chart_container' id='"+t["id"]+"chart'></div></div>",i.className="node chart "+t["style"],i.id=t["id"],setTimeout((function(){D(t["id"],t)}),1e3),i})),g["a"].registerHTMLComponent("image",(function(e){var t=e.getData(),i=document.createElement("img");return i.className="node image "+t["style"],i.src=t["src"],i.id=t["id"],i}));var I={name:"HelloWorld",props:{},components:{draggable:u.a},data:function(){var e=this;return{gitee_info:{enable:!1,username:"",repos:"",token:""},server_mode:!1,read_mode:!1,position_mode:!1,cover_msg:"加载中...",markdown:N,secretKeys:{},secretKey_show:!1,node_note_raw_text:!1,darkmode:$,loading:!1,first_load:!0,gitee_enable:!1,file_name:"untitled",file_sha:"null",file_type:"mb",graph:null,online_file:!1,selected_node:null,selected_edge:null,predefineColors:["#eeeeee","#ffffff","#000000","#b39ddb","#f44336","#009688","#0d47a1"],request_lock:!1,zoom:0,chart_styles:["line"],node_styles:["fold","plain","pin","pure-green","pure-blue","pure-yellow","pure-red","sticky","emergency","inside","light","border-flash","placeholder"],group_styles:["plain","pure-green","pure-blue","pure-yellow","pure-red","emergency"],tool_bar_list:[{name:"Xiaohao Liu",width:100,style:"margin-right: 20px;padding-right: 20px;",enable:!0,show:!0,icon:"",title:"MindBox",click:function(){e.index()}},{name:"文件名",width:200,style:"margin-right: 20px;padding-right: 20px;",enable:!0,show:!0,icon:"",title:"null",click:function(){e.__file_share_link()}},{name:"撤销",width:40,style:"",enable:!1,show:!0,icon:"iconfont icon-redo",title:"",click:function(){e.graph.undo()}},{name:"重做",width:40,style:"",enable:!1,show:!0,icon:"iconfont icon-undo",title:"",click:function(){e.graph.redo()}},{name:"子主题",width:40,style:"",enable:!1,show:!0,icon:"iconfont icon-create_child_node",title:"",click:function(){e.__tool_add_child()}},{name:"主题",width:40,style:"",enable:!1,show:!0,icon:"iconfont icon-create_sibling_node",title:"",click:function(){e.__tool_add_sibling()}},{name:"群组",width:40,style:"",enable:!1,show:!0,icon:"iconfont icon-border",title:"",click:function(){e.__tool_add_group()}},{name:"放大",width:40,style:"",enable:!0,show:!0,icon:"iconfont icon-zoomin",title:"",click:function(){e.zoom+=.2,e.graph.zoom(.2)}},{name:"复原",width:40,style:"",enable:!0,show:!0,icon:"iconfont icon-zoom",title:"",click:function(){e.graph.zoom(-e.zoom),e.zoom=0}},{name:"缩小",width:40,style:"",enable:!0,show:!0,icon:"iconfont icon-zoomout",title:"",click:function(){e.zoom-=.2,e.graph.zoom(-.2)}},{name:"注释",width:40,style:"",enable:!0,show:!0,icon:"iconfont icon-note",title:"",click:function(){e.__tool_add_note()}},{name:"图表",width:40,style:"",enable:!0,show:!0,icon:"el-icon-pie-chart",title:"",click:function(){e.__tool_add_chart()}},{name:"图片",width:40,style:"",enable:!0,show:!0,icon:"iconfont icon-pic",title:"",click:function(){e.__tool_add_pic()}},{name:"上传",width:40,style:"",enable:!0,show:!0,icon:"iconfont icon-upload",title:"",click:function(){e.__upload_to_gitee()}},{name:"深色模式",width:100,style:"",enable:this.darkmode,show:!0,type:"btn",icon:"",title:"",click:function(){e.darkmode=!e.darkmode,e.tool_bar_list[e.tool_map["darkmode"]].enable=e.darkmode}},{name:"定位",width:50,style:"",enable:!0,show:!0,icon:"el-icon-place",title:"",click:function(){e.position_mode=!0}},{name:"登出",width:60,style:"",enable:!0,show:!0,icon:"el-icon-coffee-cup",title:"",click:function(){Object(y["removeToken"])(),e.$router.push("/login")}},{name:"密钥",width:60,style:"",enable:!0,show:!0,icon:"el-icon-key",title:"",click:function(){e.secretKey_show=!e.secretKey_show}}],tool_map:{file:1,undo:2,redo:3,child:4,sibling:5,group:6,darkmode:14},read_mode_bar:new Set([0,1,2,3,7,8,9,14,15]),pushed_pic_config:{loading:!1,show:!1,name:"",base64:"",pushed:!1,raw:"",url:""},node_config:{show:!1,title:"编辑节点",label:"",note:"",fill:"",fold:"",scale:"",stroke:"",text_color:"",pin:"",can_link:!1},edge_config:{show:!1,title:"编辑链接",label:"",stroke:""},group_config:{show:!1,title:"编辑群组",label:"",stroke:""},chart_config:{show:!1,title:"编辑图表",label:"",style:"",data:"",x_axis:"",y_axis:""},image_config:{show:!1,title:"编辑图片",url:"",fullscreen:!1},file_config:{show:!1,title:"Files",label:"",loading:!1,groups:[],files:new Set},positions:[],markdown_mode:!1}},mounted:function(){var e=this;Object(y["getGiteeInfo"])().then((function(t){e.server_mode=!0,e.gitee_info=t,e.gitee_enable=e.gitee_info.enable,console.log(e.gitee_info)})).catch((function(e){console.log(e)})).finally((function(){e.__init_read_mode(),e.load_secretKeys(),e.__init_graph(),e.__add_events(),e.__add_keyboard_events(),e.read_mode&&e.__load_online_file()}))},methods:{load_secretKeys:function(){var e=this;this.read_mode||this.gAPI.get_file_by_path("mindbox.secretKeys").then((function(t){var i=e.__decode(t.data.content);"{}"==i?e.secretKeys={}:(e.secretKeys=JSON.parse(e.__decrypt(i,e.gitee_info.token)),console.log(e.secretKeys))})).catch((function(e){console.log(e)}))},upload_secretKeys:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.__upload_gitee_file("mindbox.secretKeys",this.__encode(this.__encrypt(JSON.stringify(this.secretKeys),this.gitee_info.token))));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),index:function(){!this.read_mode&&this.gitee_enable?(this.file_config.show=!this.file_config.show,1==this.file_config.show&&this.can_request()&&(this.__get_gitee_files(),this.send_a_request())):alert("MindMap\nDesined by Xiaohao Liu.\nGithub: WYKXLDZ")},__init_read_mode:function(){var e=this;this.gitee_enable||(this.read_mode=!0);try{var t={};window.location.hash.split("?")[1].split("&").forEach((function(e){var i=e.split("=");t[i[0]]=i[1]}));var i={enable:!0,username:t["u"],repos:t["r"],token:""};console.log(i),this.file_sha=t["s"],this.file_name=t["n"].split(".mb")[0],"undefined"!=t["k"]&&(this.secretKeys[t["n"]]=t["k"]),this.read_mode=!0,this.gAPI=new y["GiteeAPI"](i),this.gitee_info=i,this.tool_bar_list.forEach((function(t,i){e.read_mode_bar.has(i)||(t.show=!1)}))}catch(n){return this.read_mode?void(this.cover_msg="参数错误！"):void(this.gAPI=new y["GiteeAPI"](this.gitee_info))}},__load_online_file:function(){var e=this;if(this.can_request()){this.send_a_request(),this.loading=!0;var t=this.file_name+"."+this.file_type;this.gAPI.get_file_by_sha(this.file_sha).then((function(i){var n=e.__decode(i.data.content);t in e.secretKeys?e.jsondata=e.__decrypt(n,e.secretKeys[t]):e.jsondata=n,e.jsondata=JSON.parse(e.jsondata),"graph"in e.jsondata?(e.grpahsource=e.jsondata["graph"],e.positions=e.jsondata["positions"]):e.grpahsource=e.jsondata,e.graph.fromJSON(e.grpahsource),e.graph.centerContent(),e.tool_bar_list[e.tool_map["file"]].title=e.file_name,e.loading=!1,e.online_file=!0,e.first_load=!1,document.getElementsByTagName("title")[0].innerText=e.file_name})).catch((function(t){e.cover_msg="Wrong\n"+t,console.log("wrong:",t),e.loading=!1}))}},__init_graph:function(){var e=this;this.tool_bar_list[this.tool_map["darkmode"]].enable=this.darkmode;var t={container:document.getElementById("antv_container"),history:!0,clipboard:{enabled:!this.read_mode,useLocalStorage:!this.read_mode},grid:{size:10,visible:!0},resizing:{enabled:!this.read_mode},keyboard:{enabled:!this.read_mode,format:function(e){return e.replace(/\s/g,"").replace("cmd","command")}},selecting:{className:"select_box",enabled:!0,modifiers:"shift",multiple:!0,rubberband:!0,strict:!0,movable:!0,showNodeSelectionBox:!0},connecting:{allowBlank:!1,allowNode:!this.read_mode,allowMulti:!this.read_mode,allowLoop:!this.read_mode,allowEdge:!1,allowPort:!1,highlight:!0,snap:!0,snapline:!0,createEdge:function(){return e.graph.createEdge(E)}},panning:!0,background:{}};this.graph=new g["a"](t)},send_a_request:function(){var e=this;this.request_lock=!0,setTimeout((function(){e.request_lock=!1}),2e3)},can_request:function(){return 1!=this.request_lock||(this.$notify({title:"请求速率过快",message:"2s后重试"}),!1)},__init_an_online_project:function(){this.file_config.show=!0,this.__get_gitee_files(),this.first_load=!1,this.online_file=!0},generate_id:function(e){return e+String((new Date).getTime())},__init_a_blank_project:function(){this.graph.fromJSON({});var e={};for(var t in m.a["first"])this.$set(e,t,m.a["first"][t]);this.$set(e["data"],"id",this.generate_id("first")),this.graph.addNode(e),this.graph.centerContent(),this.tool_bar_list[this.tool_map["file"]].title=this.file_name,this.file_name="untitled",this.tool_bar_list[this.tool_map["file"]].title=this.file_name,this.first_load=!1,this.online_file=!1,document.getElementsByTagName("title")[0].innerText="new file"},__enable:function(e){this.tool_bar_list[this.tool_map[e]].enable=!0},__disable:function(e){this.tool_bar_list[this.tool_map[e]].enable=!1},__update_chart:function(){this.selected_node.updateData({title:this.chart_config.title,data:this.chart_config.data,style:this.chart_config.style,x_axis:this.chart_config.x_axis,y_axis:this.chart_config.y_axis});var e=this.selected_node.getData()["id"];D(e,this.chart_config)},__change_node_title:function(){this.selected_node.updateData({title:this.node_config.title});var e=document.getElementById(this.selected_node.getData()["id"]+"box").getElementsByClassName("title")[0];e.innerHTML=this.markdown.render(this.node_config.title);var t=document.getElementById(this.selected_node.getData()["id"]).offsetWidth+20,i=this.selected_node.getProp("size");this.selected_node.setProp("size",{width:t,height:i.height})},__change_node_can_link:function(){var e=document.getElementById(this.selected_node.getData()["id"]+"box");this.selected_node&&e.setAttribute("magnet",this.node_config.can_link)},__change_node_note:function(){if(this.selected_node.updateData({note:this.node_config.note}),"note"==this.selected_node.getData()["type"]){var e=document.getElementById(this.selected_node.getData()["id"]+"box").getElementsByClassName("content")[0];e.innerHTML=this.markdown.render(this.node_config.note)}},__change_node_style:function(){this.selected_node.updateData({style:this.node_config.style});var e=document.getElementById(this.selected_node.getData()["id"]),t=e.className.split(" ");e.className=[t[0],t[1],this.node_config.style].join(" "),"pin"!=this.node_config.style||"pin"in this.selected_node.getData()||(this.selected_node.setData({pin:"📌"}),this.node_config.pin="📌",this.__change_node_pin())},__change_node_pin:function(){var e=this;this.selected_node.updateData({pin:this.node_config.pin});var t=document.getElementById(this.selected_node.getData()["id"]).getElementsByClassName("pinner");t.forEach((function(t){t.innerHTML=e.node_config.pin.substring(0)}))},__change_node_fold:function(){this.selected_node.updateData({fold:this.node_config.fold});var e=document.getElementById(this.selected_node.getData()["id"]);this.node_config.fold?e.className=e.className.replace("non-folding","folding"):e.className=e.className.replace("folding","non-folding")},__increase_node_scale:function(){"min"==this.node_config.scale?(this.node_config.scale="mid",this.___change_node_scale("min")):"mid"==this.node_config.scale&&(this.node_config.scale="max",this.___change_node_scale("mid"))},__decrease_node_scale:function(){"mid"==this.node_config.scale?(this.node_config.scale="min",this.___change_node_scale("mid")):"max"==this.node_config.scale&&(this.node_config.scale="mid",this.___change_node_scale("max"))},___change_node_scale:function(e){var t=document.getElementById(this.selected_node.getData()["id"]);t.className.indexOf(e)>-1?t.className=t.className.replace(e,this.node_config.scale):t.className=t.className+" "+this.node_config.scale,this.selected_node.updateData({scale:this.node_config.scale})},__change_group_style:function(){this.selected_node.updateData({style:this.group_config.style});var e=document.getElementById(this.selected_node.getData()["id"]),t=e.className.split(" ");e.className=[t[0],t[1],this.group_config.style].join(" ")},__change_edge_label:function(){""==this.edge_config.label?this.selected_edge.setLabels({attrs:{text:{text:""}}}):this.selected_edge.setLabels({attrs:{text:{text:" "+this.edge_config.label+" "}}})},__change_image_url:function(){this.selected_node.attr({image:{"xlink:href":this.image_config.url}})},__add_events:function(){var e=this;this.graph.on("node:selected",(function(t){var i=e.graph.getSelectedCells();e.selected_node=t.node;var n=e.selected_node.getData();return i.length>1?(e.__enable("group"),e.__disable("child"),e.__disable("sibling"),e.group_config.show=!1,e.node_config.show=!1,e.edge_config.show=!1,e.chart_config.show=!1,e.image_config.show=!1,!1):"image"==n.type?(e.image_config.show=!0,e.image_config.url=n.src,!1):"group"==n.type?(e.group_config.show=!0,e.group_config.style=n.style,!1):"chart"==n.type?(e.chart_config.show=!0,e.chart_config.style=n.style,e.chart_config.data=n.data,e.chart_config.title=n.title,e.chart_config.x_axis=n.x_axis,e.chart_config.y_axis=n.y_axis,!1):(e.node_config=n,"true"==document.getElementById(n["id"]+"box").getAttribute("magnet")?e.node_config.can_link=!0:e.node_config.can_link=!1,"fold"in n||(e.node_config.fold=!1,e.selected_node.setData({fold:!1})),"scale"in n||(e.node_config.scale="mid",e.selected_node.setData({scale:"mid"})),e.node_config.show=!0,e.edge_config.show=!1,e.group_config.show=!1,e.chart_config.show=!1,e.image_config.show=!1,e.__disable("group"),e.__enable("child"),e.node_config.note=e.selected_node.store.data.data.note,void(0!=e.selected_node.store.data.idx&&e.__enable("sibling")))})),this.graph.on("node:unselected",(function(){e.selected_node=null,e.node_config.show=!1,e.__disable("child"),e.__disable("sibling"),e.__disable("group")})),this.graph.on("edge:click",(function(t){e.selected_edge=t.edge,e.edge_config.show=!0,e.node_config.show=!1,e.chart_config.show=!1,e.group_config.show=!1;try{e.edge_config.label=e.selected_edge.getLabels()[0].attrs.text.text.trim()}catch(i){e.edge_config.label=""}})),this.graph.on("edge:connected",(function(t){if(t.isNew){var i=t.edge.store.data.source.cell,n=t.edge.store.data.target.cell;e.graph.getCell(n).setData({parent:i})}})),this.history=this.graph.history,this.history.on("change",(function(){e.history.canRedo()?e.__enable("redo"):e.__disable("redo"),e.history.canUndo()?e.__enable("undo"):e.__disable("undo")})),this.graph.on("blank:click",(function(){e.edge_config.show=!1,e.node_config.show=!1,e.group_config.show=!1,e.file_config.show=!1,e.chart_config.show=!1,e.image_config.show=!1,e.pushed_pic_config.show=!1,e.markdown_mode=!1})),this.__add_paste_event()},__add_keyboard_events:function(){var e=this;this.graph.bindKey("enter",(function(){e.__tool_add_sibling()})),this.graph.bindKey("ctrl+enter",(function(){e.__tool_add_child()})),this.graph.bindKey("backspace",(function(){e.__del_node()})),this.graph.bindKey("ctrl+c",(function(){var t=e.graph.getSelectedCells();if(t.length){var i=[];t.forEach((function(e){0!=e.store.data.idx&&i.push(e)})),e.graph.copy(i)}return!1})),this.graph.bindKey("ctrl+v",(function(){if(!e.graph.isClipboardEmpty()){var t=e.graph.paste({offset:32});e.graph.cleanSelection(),e.graph.select(t)}return!1})),this.graph.bindKey("ctrl+z",(function(){e.history.canUndo()&&e.graph.undo()})),this.graph.bindKey("ctrl+s",(function(){e.__upload_to_gitee()})),this.graph.bindKey("ctrl+n",(function(){e.__init_a_blank_project()}))},__add_paste_event:function(){var e=this,t=",.'\":; ";document.addEventListener("paste",(function(i){if(e.pushed_pic_config.show){var n=i.clipboardData&&i.clipboardData.items,o=null,s=new FileReader;if(n&&n.length)for(var a=0;a<n.length;a++)if(-1!==n[a].type.indexOf("image")){o=n[a].getAsFile();break}for(var r=e.file_name.substring(0,15).toLowerCase(),c=0;c<t.length;c++)r=r.split(t[c]).join("_");r+="_1.png",s.onload=function(t){e.pushed_pic_config.base64=t.target.result,e.pushed_pic_config.url=e.pushed_pic_config.base64,e.pushed_pic_config.name=r,e.pushed_pic_config.pushed=!1},o&&s.readAsDataURL(o)}}))},__del_node:function(){null!=this.selected_node&&0!=this.selected_node.store.data.idx&&(this.graph.removeNode(this.selected_node.id),this.node_config.show=!1,this.image_config.show=!1,this.$message("删除成功"))},__del_group:function(){var e=this;null!=this.selected_node&&4==this.selected_node.store.data.idx&&(this.selected_node.getChildren().forEach((function(t){e.selected_node.unembed(t)})),this.group_config.show=!1,this.graph.removeNode(this.selected_node.id),this.$message("删除成功"))},__del_chart:function(){this.__del_node()},__del_edge:function(){this.graph.removeEdge(this.selected_edge.id),this.edge_config.show=!1,this.$message("删除成功")},__del_image:function(){null!=this.selected_node&&0!=this.selected_node.store.data.idx&&(this.graph.removeNode(this.selected_node.id),this.image_config.show=!1,this.$message("删除成功"))},__tool_add_secret_key:function(){var e=S.MD5(this.file_name+this.file_type+this.gitee_info.token+String((new Date).getTime())).toString();this.$set(this.secretKeys,this.file_name+"."+this.file_type,e)},__tool_remove_secret_key:function(){var e=this.file_name+"."+this.file_type;e in this.secretKeys&&this.$delete(this.secretKeys,e)},__tool_add_note:function(){var e={};for(var t in m.a["note"])this.$set(e,t,m.a["note"][t]);this.$set(e["data"],"id",this.generate_id("note"));var i=this.graph.pageToLocal(window.innerWidth/2,window.innerHeight/2);e.x=i.x,e.y=i.y,this.graph.addNode(e)},__tool_add_chart:function(){var e={};for(var t in m.a["chart"])this.$set(e,t,m.a["chart"][t]);this.$set(e["data"],"id",this.generate_id("chart"));var i=this.graph.pageToLocal(window.innerWidth/2,window.innerHeight/2);e.x=i.x,e.y=i.y,this.graph.addNode(e)},__tool_add_pic:function(){this.pushed_pic_config.show=!this.pushed_pic_config.show},__tool_add_pic_2:function(){var e={};for(var t in m.a["image"])this.$set(e,t,m.a["image"][t]);this.$set(e["data"],"id",this.generate_id("image"));var i=this.graph.pageToLocal(window.innerWidth/2,window.innerHeight/2);e.x=i.x,e.y=i.y,e.width=document.getElementById("pushed_image").offsetWidth,e.height=document.getElementById("pushed_image").offsetHeight,this.$set(e["data"],"src",this.pushed_pic_config.url),this.graph.addNode(e),this.pushed_pic_config.pushed=!1,this.pushed_pic_config.show=!1,this.pushed_pic_config.url="",this.pushed_pic_config.name="",this.pushed_pic_config.base64=""},__tool_add_child:function(){if(null!=this.selected_node){var e=this.selected_node.store.data.idx,t={};if(0==e){for(var i in m.a["second"])this.$set(t,i,m.a["second"][i]);this.$set(t["data"],"id",this.generate_id("second"))}else{for(var n in m.a["others"])this.$set(t,n,m.a["others"][n]);this.$set(t["data"],"id",this.generate_id("others"))}t.parent=this.selected_node.id;var o=this.graph.addNode(t);o.setData({parent:t.parent}),o.setProp("position",{x:this.selected_node.store.data.position.x+parseInt(10*Math.random()),y:this.selected_node.store.data.position.y+this.selected_node.store.data.size.height+40});var s={};for(var a in m.a["edge"])s[a]=m.a["edge"][a];s.source=t.parent,s.target=o.id,this.graph.unselect(this.selected_node),this.graph.select(o),this.graph.addEdge(s),this.$message("添加子主题成功")}},__tool_add_sibling:function(){if(null!=this.selected_node){var e=this.selected_node.store.data.idx,t={};if(0!=e){if(1==e){for(var i in m.a["second"])this.$set(t,i,m.a["second"][i]);this.$set(t["data"],"id",this.generate_id("second"))}else{for(var n in m.a["others"])this.$set(t,n,m.a["others"][n]);this.$set(t["data"],"id",this.generate_id("others"))}t.parent=this.selected_node.getData().parent;var o=this.graph.addNode(t);o.setData({parent:t.parent}),o.setProp("position",{x:this.selected_node.store.data.position.x+this.selected_node.store.data.size.width+10,y:this.selected_node.store.data.position.y+parseInt(10*Math.random())});var s={};for(var a in m.a["edge"])s[a]=m.a["edge"][a];s.source=t.parent,s.target=o.id,this.graph.unselect(this.selected_node),this.graph.select(o),this.graph.addEdge(s),this.$message("添加主题成功")}}},__tool_add_group:function(){var e=this.graph.getSelectedCells(),t=m.a["group"];this.$set(t["data"],"id",this.generate_id("group"));var i=10;if(e.length){var n=0,o=0,s=0,a=0,r=this.graph.addNode(t),c=[],l=[];e.forEach((function(e){c.push(e.store.data.position.x-i),l.push(e.store.data.position.y-i),c.push(e.store.data.position.x+e.store.data.size.width+i),l.push(e.store.data.position.y+e.store.data.size.height+i),r.addChild(e)})),n=Math.min.apply(null,c),o=Math.min.apply(null,l),s=Math.max.apply(null,l)-o,a=Math.max.apply(null,c)-n,r.setProp("size",{width:a,height:s}),r.setProp("position",{x:n,y:o})}return!1},add_position:function(){var e=this;this.$prompt("请输入位置名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(t){var i=t.value;e.positions.push({name:i,x:e.graph.coord.options.x,y:e.graph.coord.options.y}),e.$message({type:"success",message:"新建位置成功："+i})})).catch((function(){e.$message({type:"info",message:"取消输入"})}))},delte_position:function(e){for(var t=0;t<this.positions.length;t++)if(JSON.stringify(this.positions[t])==JSON.stringify(e)){this.positions.splice(t,1);break}},to_position:function(e){this.graph.translate(e.x,e.y)},__file_share_link:function(){var e=this;if(this.online_file){var t="http://wykxldz.gitee.io/mindbox/#/read?u="+this.gitee_info.username+"&r="+this.gitee_info.repos+"&s="+this.file_sha+"&n="+this.file_name+"."+this.file_type+"&k="+this.secretKeys[this.file_name+"."+this.file_type];this.$alert("","分享阅读链接",{showInput:!0,inputValue:t})}else this.$prompt("请输入文件名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^([0-9a-zA-z]{1})([\w]*)$/g,inputPlaceholder:this.file_name,inputErrorMessage:"文件格式不正确"}).then((function(t){var i=t.value;e.file_config.files.has(i)?e.$message({type:"warning",message:"已存在该文件名"}):(e.file_name=i,e.tool_bar_list[e.tool_map["file"]].title=e.file_name,e.$message({type:"success",message:"修改成功"}))})).catch((function(){e.$message({type:"info",message:"取消输入"})}))},__get_gitee_files:function(){var e=this;console.log(this.gitee_info),""!=this.gitee_info.username&&""!=this.gitee_info.repos&&""!=this.gitee_info.token?(this.file_config.loading=!0,this.gAPI.get_files().then((function(t){var i=t.data.tree;e.file_config.groups.splice(0,e.file_config.groups.length);for(var n=0;n<i.length;n++)if("MindBox_file_groups"==i[n].path){e.gAPI.get_file_by_sha(i[n].sha).then((function(t){e.file_config.groups=JSON.parse(e.__decode(t.data.content))})).catch((function(){e.file_config.groups.push({name:"Files",list:[]})})).finally((function(){for(var t=new Set,n=new Set,o={},s=1;s<e.file_config.groups.length;s++)e.file_config.groups[s].list.forEach((function(i){t.add(i.path.split("."+e.file_type)[0])}));e.file_config.groups[0].list.splice(0,e.file_config.groups[0].list.length);for(var a=0;a<i.length;a++){var r=i[a].path.split(".");if(r[r.length-1]==e.file_type){var c=i[a].path.split("."+e.file_type)[0];e.file_config.files.add(c),t.has(c)?(n.add(c),o[c]=i[a]):e.file_config.groups[0].list.push(i[a])}}function l(e,t){var i,n=new Set(e),o=Object(h["a"])(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;n.delete(s)}}catch(a){o.e(a)}finally{o.f()}return n}for(var d=l(t,n),_=function(t){e.file_config.groups[t].list.forEach((function(i,s){var a=i.path.split("."+e.file_type)[0];if(d.has(a)&&e.file_config.groups[t].list.splice(s,s+1),n.has(a))for(var r in i)i[r]=o[a][r]}))},g=1;g<e.file_config.groups.length;g++)_(g);e.file_config.loading=!1}));break}e.file_config.groups.push({name:"Files",list:[]});for(var o=0;o<i.length;o++){var s=i[o].path.split(".");s[s.length-1]==e.file_type&&e.file_config.groups[0].list.push(i[o])}e.file_config.loading=!1})).catch((function(){e.file_config.loading=!1}))):this.$notify({title:" 失败",message:"Gitee 信息有误"})},__load_gitee_file:function(e,t){var i=this;""!=this.gitee_info.username&&""!=this.gitee_info.repos&&""!=this.gitee_info.token?this.can_request()&&(this.send_a_request(),this.loading=!0,this.file_config.show=!1,this.gAPI.get_file_by_sha(t).then((function(n){var o=i.__decode(n.data.content);e in i.secretKeys?i.jsondata=i.__decrypt(o,i.secretKeys[e]):i.jsondata=o,i.jsondata=JSON.parse(i.jsondata),"graph"in i.jsondata?(i.grpahsource=i.jsondata["graph"],i.positions=i.jsondata["positions"]):i.grpahsource=i.jsondata,i.check_graph_source(i.grpahsource),i.graph.fromJSON(i.grpahsource),i.graph.centerContent(),i.file_name=e.split(".mb")[0],i.file_sha=t,i.tool_bar_list[i.tool_map["file"]].title=i.file_name,i.loading=!1,i.online_file=!0,document.getElementsByTagName("title")[0].innerText=i.file_name})).catch((function(e){console.log(e),i.loading=!1}))):this.$notify({title:" 失败",message:"Gitee 信息有误"})},check_graph_source:function(e){e.cells.forEach((function(e){"ports"in e||(e.ports=Object(_["a"])({},j))}))},__upload_gitee_file:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,i){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){return""==n.gitee_info.username||""==n.gitee_info.repos||""==n.gitee_info.token?(n.$notify({title:" 失败",message:"Gitee 信息有误"}),o(!1),!1):n.can_request()?(n.send_a_request(),void n.gAPI.get_file_by_path(t).then((function(s){if(0==s.data.length){var a={content:i};n.gAPI.new_file(t,a).then((function(i){n.$notify({title:"成功",message:t+" 上传成功！"}),n.file_sha=i.data.content.sha,n.file_name=i.data.content.name.split(".mb")[0],e(i.data)})).catch((function(e){n.$notify({title:" 失败",message:e.data.responseJSON.message}),o(e.data)}))}else n.$alert("是否替换"+t,"替换",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={content:i,sha:s.data.sha};n.gAPI.update_file(t,a).then((function(i){n.$notify({title:"成功",message:t+" 替换成功！"}),console.log(i.data),n.file_sha=i.data.content.sha,n.file_name=i.data.content.name.split(".mb")[0],e(i.data)})).catch((function(e){n.$notify({title:" 失败",message:e.data.responseJSON.message}),o(e.data)}))})).catch((function(e){n.$notify({title:"取消替换",message:""}),o(e.data)}))})).catch((function(){n.$notify({title:" 失败",message:"请求出错"})}))):(o(!1),!1)})));case 1:case"end":return e.stop()}}),e)})));function t(t,i){return e.apply(this,arguments)}return t}(),__upload_to_gitee:function(){var e=this,t=JSON.stringify({graph:this.graph.toJSON(),positions:this.positions}),i=this.file_name+"."+this.file_type;this.loading=!0;var n=null;if(i in this.secretKeys){n=this.secretKeys[i],console.log(n),console.log(t);var o=this.__encode(this.__encrypt(t,n));this.upload_secretKeys().then((function(){setTimeout((function(){e.__upload_gitee_file(i,o).then((function(){e.loading=!1})).catch((function(){e.loading=!1}))}),2e3)})).catch((function(){e.loading=!1}))}else{var s=this.__encode(t);this.upload_secretKeys().then((function(){setTimeout((function(){e.__upload_gitee_file(i,s).then((function(){e.loading=!1})).catch((function(){e.loading=!1}))}),2e3)})).catch((function(){e.loading=!1}))}},__upload_pic_to_gitee_file:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,i,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.pushed_pic_config.base64.substring(22),i=this.pushed_pic_config.name,e.abrupt("return",new Promise((function(e,o){return""==n.gitee_info.username||""==n.gitee_info.repos||""==n.gitee_info.token?(n.$notify({title:" 失败",message:"Gitee 信息有误"}),o(!1),!1):(n.pushed_pic_config.loading=!0,n.can_request()?(n.send_a_request(),void n.gAPI.get_file_by_path(i).then((function(s){if(0==s.data.length){var a={content:t};n.gAPI.new_file(i,a).then((function(t){n.$notify({title:"成功",message:i+" 上传成功！"}),n.pushed_pic_config.url=t.data.content.download_url,n.pushed_pic_config.loading=!1,e(t.data)})).catch((function(e){n.$notify({title:" 失败",message:e.data.responseJSON.message}),n.pushed_pic_config.loading=!1,o(e.data)}))}else n.$alert("是否替换图片"+i,"替换",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={content:t,sha:s.data.sha};n.gAPI.update_file(i,a).then((function(t){n.$notify({title:"成功",message:i+" 替换成功！"}),n.pushed_pic_config.url=t.data.content.download_url,n.pushed_pic_config.loading=!1,e(t.data)})).catch((function(e){n.$notify({title:" 失败",message:e.data.responseJSON.message}),n.pushed_pic_config.loading=!1,o(e.data)}))})).catch((function(e){n.$notify({title:"取消替换",message:""}),n.pushed_pic_config.loading=!1,o(e.data)}))})).catch((function(){n.$notify({title:" 失败",message:"请求出错"}),n.pushed_pic_config.loading=!1}))):(o(!1),!1))})));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),__open_file_group:function(e){e<this.file_config.list.groups.length&&(this.file_config.group.idx=e,this.file_config.group.show=!0)},__upload_file_group:function(){var e=this,t=this.__encode(JSON.stringify(this.file_config.groups)),i="MindBox_file_groups";return new Promise((function(n,o){return""==e.gitee_info.username||""==e.gitee_info.repos||""==e.gitee_info.token?(e.$notify({title:" 失败",message:"Gitee 信息有误"}),o(!1),!1):(e.file_config.loading=!0,e.can_request()?(e.send_a_request(),void e.gAPI.get_file_by_path(i).then((function(s){if(0==s.data.length){var a={content:t};e.gAPI.new_file(i,a).then((function(t){e.$notify({title:"成功",message:i+" 上传成功！"}),e.file_config.loading=!1,n(t.data)})).catch((function(t){e.$notify({title:" 失败",message:t.data.responseJSON.message}),e.file_config.loading=!1,o(t.data)}))}else{var r={content:t,sha:s.data.sha};e.gAPI.update_file(i,r).then((function(t){e.$notify({title:"成功",message:i+" 替换成功！"}),e.file_config.loading=!1,n(t.data)})).catch((function(t){e.$notify({title:"取消",message:""}),e.file_config.loading=!1,o(t.data)}))}})).catch((function(){e.$notify({title:" 失败",message:"请求出错"}),e.file_config.loading=!1}))):(o(!1),!1))}))},__delete_file_group:function(e){console.log(e),this.file_config.groups.splice(e,e+1)},__add_file_group:function(){var e=this;this.$prompt("请输入群组名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/[\w]+/,inputErrorMessage:"格式不正确"}).then((function(t){var i=t.value;e.file_config.groups.push({name:i,list:[]}),e.$message({type:"success",message:"新建群组: "+i})})).catch((function(){e.$message({type:"info",message:"取消输入"})}))},__encode:function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))},__decode:function(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},__encrypt:function(e,t){return S.AES.encrypt(e,t)},__decrypt:function(e,t){return S.AES.decrypt(e,t).toString(S.enc.Utf8)},colorHex:function(e){var t=/^(rgb|RGB)/;if(t.test(e)){for(var i="#",n=e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),o=0;o<n.length;o++){var s=Number(n[o]).toString(16);"0"===s&&(s+=s),i+=s}return i}return String(e)},colorRgb:function(e){var t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(e=e.toLowerCase(),t.test(e)){if(4===e.length){for(var i="#",n=1;n<4;n+=1)i+=e.slice(n,n+1).concat(e.slice(n,n+1));e=i}for(var o=[],s=1;s<7;s+=2)o.push(parseInt("0x"+e.slice(s,s+2)));return"RGB("+o.join(",")+")"}return e},getElementsByAttr:function(e,t,i){for(var n=document.getElementsByTagName(e),o=0;o<=n.length;o++)if(n[o].getAttribute(t)==i)return n[o]}}},A=I,P=(i("d880"),i("b93b"),i("2877")),O=Object(P["a"])(A,l,d,!1,null,"1b2d7d42",null),z=O.exports,L=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bg"},[e.is_first_set?i("div",{staticClass:"board"},[i("p",{staticClass:"msg_board",style:{color:e.msg_color}},[e._v(e._s(e.msg))]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"text"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),i("div",{staticClass:"button",on:{click:function(t){return e.first_set()}}},[e._v("Submit")])]):i("div",{staticClass:"board"},[i("p",{staticClass:"msg_board"},[e._v(e._s(e.msg))]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"password"},domProps:{value:e.password},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login()},input:function(t){t.target.composing||(e.password=t.target.value)}}}),i("div",{staticClass:"button",on:{click:function(t){return e.login()}}},[e._v("Login")])])])},B=[],K=i("d722"),M=K.checkFirst,R=K.login,H=K.firstSet,W=K.setToken,J={data:function(){return{msg:"This is the first time you enter this website, thus input your password at the beginning.",password:"",is_first_set:!0,msg_color:"black"}},mounted:function(){var e=this;M().then((function(t){e.is_first_set=t.data.is_first,console.log(t),e.is_first_set||(e.msg="Please input your password.")}))},methods:{first_set:function(){var e=this;if(this.password.length<6)return console.log(this.password),this.msg="Please input at least 6 characters.",this.msg_color="red",null;H({password:this.password}).then((function(t){e.msg="Success.",e.msg_color="green",console.log(t),e.is_first_set=!1}))},login:function(){var e=this;if(this.password.length<6)return console.log(this.password),this.msg="Please input at least 6 characters.",this.msg_color="red",null;R({password:this.password}).then((function(t){e.msg="Success.",e.msg_color="green",W(t.token),e.$router.push("/")}))}}},q=J,G=(i("2042"),Object(P["a"])(q,L,B,!1,null,"10ffc01d",null)),F=G.exports,U=i("8c4f"),X=new U["a"]({routes:[{path:"/",component:z,alias:["/mindbox","/read"]},{path:"/login",component:F}]}),Y=i("d722"),V=Y.getToken,Z=["/login"];X.beforeEach(function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,i,n){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=V(),"/read"===t.path?n():o?"/login"===t.path?n({path:"/"}):n():-1!==Z.indexOf(t.path)?n():n("/login");case 2:case"end":return e.stop()}}),e)})));return function(t,i,n){return e.apply(this,arguments)}}());var Q={router:X},ee=Q,te=(i("034f"),Object(P["a"])(ee,a,r,!1,null,null,null)),ie=te.exports;n["default"].use(U["a"]),n["default"].use(s.a),new n["default"]({el:"#app",render:function(e){return e(ie)}})},"85ec":function(e,t,i){},8647:function(e,t,i){var n=i("ded3"),o={groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}}}},items:[{group:"top"},{group:"bottom"},{group:"left"},{group:"right"}]};e.exports={first:{width:120,height:60,shape:"html",html:"first",data:{type:"first",id:"",title:"Text",style:"plain",note:""},zIndex:10,ignore_layout:!1,idx:0,ports:n({},o)},second:{width:100,height:40,shape:"html",html:"second",data:{type:"second",id:"",title:"Text",style:"plain",note:""},idx:1,zIndex:10,ignore_layout:!1,ports:n({},o)},others:{width:80,height:20,shape:"html",html:"others",data:{type:"others",id:"",title:"Text",style:"plain",note:""},idx:2,zIndex:10,ignore_layout:!1,ports:n({},o)},note:{width:100,height:40,shape:"html",html:"note",data:{type:"note",id:"",title:"Note",style:"plain",note:""},zIndex:10,idx:3,ignore_layout:!0,ports:n({},o)},edge:{source:"",target:"",connector:{name:"rounded"},zIndex:10},group:{width:100,height:40,label:"",shape:"html",html:"group",data:{type:"group",id:"",title:"",style:"plain",note:""},zIndex:1,idx:4,ports:n({},o)},chart:{width:400,height:250,label:"",shape:"html",html:"chart",data:{type:"chart",id:"",data:"",title:"chart title",x_axis:"x",y_axis:"y",style:"line"},zIndex:1,idx:4,ports:n({},o)},image:{width:100,height:100,shape:"html",html:"image",data:{type:"image",id:"",src:""},ports:n({},o)}}},b93b:function(e,t,i){"use strict";i("c9a1")},be35:function(e,t,i){},c473:function(e,t,i){},c4b1:function(e,t,i){},c9a1:function(e,t,i){},d722:function(e,t,i){i("d3b7"),i("96cf");var n=i("c973"),o=i("bc3a").default;function s(e){this.username=e.username,this.token=e.token,this.repos=e.repos}s.prototype={get_files:function(){var e=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",o({method:"get",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/git/trees/master",responseType:"json",headers:{Authorization:"token "+this.token}}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),get_file_by_sha:function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",o({method:"get",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/git/blobs/"+t,responseType:"json",headers:{Authorization:"token "+this.token}}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),get_file_by_path:function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",o({method:"get",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/contents/"+t,responseType:"json",headers:{Authorization:"token "+this.token}}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),new_file:function(){var e=n(regeneratorRuntime.mark((function e(t,i){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={access_token:this.token,owner:this.username,repo:this.repos,path:t,message:"[new file] "+t,content:i.content},e.abrupt("return",o({method:"post",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/contents/"+t,responseType:"json",headers:{Authorization:"token "+this.token},data:i}));case 2:case"end":return e.stop()}}),e,this)})));function t(t,i){return e.apply(this,arguments)}return t}(),update_file:function(){var e=n(regeneratorRuntime.mark((function e(t,i){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={access_token:this.token,owner:this.username,repo:this.repos,path:t,message:"[update file] "+t,content:i.content,sha:i.sha},e.abrupt("return",o({method:"put",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/contents/"+t,responseType:"json",headers:{Authorization:"token "+this.token},data:i}));case 2:case"end":return e.stop()}}),e,this)})));function t(t,i){return e.apply(this,arguments)}return t}()};var a=i("852e"),r="User-Token";function c(){return a.get(r)}function l(e){return a.set(r,e)}function d(){return a.remove(r)}var _=o.create({baseURL:"",timeout:5e3});function h(){return g.apply(this,arguments)}function g(){return g=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",_({method:"get",url:"/api/giteeinfo",responseType:"json"}));case 1:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function f(){return u.apply(this,arguments)}function u(){return u=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",_({method:"get",url:"/api/is_first"}));case 1:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return m=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",_({method:"post",url:"/api/first_set",data:t}));case 1:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return b=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",_({url:"/api/login",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}_.interceptors.request.use((function(e){var t=c();return t&&(e.headers["Authorization"]=t),e}),(function(e){return Promise.reject(e)})),_.interceptors.response.use((function(e){var t=e.data||{};return-1==t.code?Promise.reject(new Error(t.msg||"Error")):t}),(function(e){var t=e.response||{};return 401===t.status&&d(),Promise.reject(e)})),e.exports={GiteeAPI:s,checkFirst:f,firstSet:p,login:v,getGiteeInfo:h,setToken:l,getToken:c,removeToken:d}},d880:function(e,t,i){"use strict";i("1c67")}});
//# sourceMappingURL=index.576e38e6.js.map